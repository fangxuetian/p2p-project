<%namespace "Agp2p.Core"%>
<!DOCTYPE html>
<html>
<head lang="zh-cmn-Hans">
    <meta charset="UTF-8">
    <title>首页</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link type="text/css" rel="stylesheet" href="<%templateskin%>/css/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="<%templateskin%>/css/common.css">
    <link type="text/css" rel="stylesheet" href="<%templateskin%>/css/index.css">
    <link type="text/css" rel="stylesheet" href="<%templateskin%>/css/footer.css">
    <link type="text/css" rel="stylesheet" href="<%templateskin%>/css/invest-list.css">
    <script src="<%templateskin%>/js/jquery-2.1.4.min.js"></script>
    <script src="<%templateskin%>/js/radialIndicator.min.js"></script>
    <script>
        /*rem的相对单位定义*/
        var viewportWidth = $(window).width();
        var fontSizeUnit = viewportWidth / 20;
        $("html").css("font-size", fontSizeUnit);

        $(function () {
            $('.indicatorContainer').each(function(index, obj) {
                $(obj).radialIndicator({
                    radius: 28,
                    barColor: '#ff414b',
                    barBgColor: '#d9d9d9',
                    barWidth: 2,
                    initValue: $(obj).attr('data-progress'),
                    roundCorner: true,
                    percentage: true
                });
            });
        });
    </script>
</head>
<body>
    <div class="index-page">
        <%if(!IsUserLogin())%>
        <div class="reglog-bar flex flex-vertical-align flex--flex-grow-first">
            <span><img src="<%templateskin%>/imgs/agrh.png"></span>
            <a href="<%linkurl("register")%>">快速注册</a>
            <a href="<%linkurl("login")%>">登录</a>
        </div>
        <%/if%>
        <div id="banner-carousel" class="carousel slide" data-ride="carousel">
            <!--<ol class="carousel-indicators">
                <li data-target="#banner-carousel" data-slide-to="0" class="active"></li>
                <li data-target="#banner-carousel" data-slide-to="1"></li>
                <li data-target="#banner-carousel" data-slide-to="2"></li>
            </ol>-->
            <div class="carousel-inner" role="listbox">
                <div class="item active">
                    <img src="<%templateskin%>/imgs/banner/banner-1.png">
                </div>
            </div>
        </div>
        <div class="invest-list">
            <%set var totalcount=0%>
            <%set var projects=QueryProjects(5,0,out totalcount,0,0,0,0)%>
            <%foreach(var p in projects)%>
            <div class="invest-project" onclick="location.href='<%linkurl("project",p.id)%>#project'">
                <p class="invest-title">
                    <span class="project-type">房贷宝</span>
                    {p.title}
                    <%if((p.tag&(int)Agp2pEnums.ProjectTagEnum.Ordered)>0)%>
                    <span class="book-icon">约标</span>
                    <%/if%>
                    <%if((p.tag&(int)Agp2pEnums.ProjectTagEnum.Recommend)>0)%>
                    <%/if%>
                    <%if((p.tag&(int)Agp2pEnums.ProjectTagEnum.CreditGuarantee)>0)%>
                    <%/if%>
                </p>
                <div class="invest-content flex flex-vertical-align flex--flex-grow-all">
                    <div class="rate-wrap">
                        <div class="title-style">年化利率</div>
                        <div class="txt-red-s"><span class="txt-red-l"><%=p.profit_rate_year.ToString("f1")%></span> %</div>
                    </div>
                    <div class="time-wrap">
                        <div class="title-style">期限</div>
                        <div><span class="txt-darkgrey-l">{p.repayment_term_span_count}</span> {p.GetProjectTermSpanEnumDesc()}</div>
                    </div>
                    <div class="amount-wrap">
                        <div class="title-style">借款金额</div>
                        <div><span class="txt-darkgrey-l"><%=p.financing_amount.ToString("n0")%></span> 元</div>
                    </div>
                    <div class="invest-status flex flex-center-wrapper">
                        <%if(p.status==(int)Agp2p.Common.Agp2pEnums.ProjectStatusEnum.FinancingAtTime) %>
                        <div class="status-wrap"><div class="over-icon">待发标</div></div>
                        <%else if(p.status==(int)Agp2p.Common.Agp2pEnums.ProjectStatusEnum.Financing) %>
                        <div class="indicatorContainer" data-progress="<%=(p.GetInvestmentProgressPercent()*100)%>"></div>
                        <%else if(p.status==(int)Agp2p.Common.Agp2pEnums.ProjectStatusEnum.FinancingTimeout||p.status==(int)Agp2p.Common.Agp2pEnums.ProjectStatusEnum.FinancingSuccess) %>
                        <div class="status-wrap"><div class="over-icon">审核中</div></div>
                        <%else if(p.status==(int)Agp2p.Common.Agp2pEnums.ProjectStatusEnum.ProjectRepaying) %>
                        <div class="status-wrap"><div class="over-icon">还款中</div></div>
                        <%else if(p.status>=(int)Agp2p.Common.Agp2pEnums.ProjectStatusEnum.RepayCompleteIntime) %>
                        <div class="status-wrap"><div class="over-icon">已结束</div></div>
                        <%/if%>
                    </div>
                </div>
            </div>
            <%/foreach%>
        </div>
        <%template src="_footer.html"%>
    </div>
</body>
</html>